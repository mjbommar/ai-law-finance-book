% ============================================================================
% 10-delegation.tex
% Q9: How Does an Agent Work with Other Agents?
% Part of: Chapter 07 - Agents Part II: How to Build an Agent
% ============================================================================

\section{How Does an Agent Work with Other Agents?}
\label{sec:agents2-delegation}

% ----------------------------------------------------------------------------
% Opening: Q9 Framing and Organizational Analogy
% ----------------------------------------------------------------------------

Complex matters require coordination. An M\&A partner does not execute everything personally; they coordinate specialists. Corporate counsel reviews governance, tax specialists analyze structure, and antitrust counsel assesses regulatory risk. Each specialist has deep expertise in their domain. The partner orchestrates: defining deliverables, integrating work products, and synthesizing conclusions for the client.

A portfolio manager coordinates similarly: analysts provide company analysis, traders handle execution, risk managers monitor exposure, and compliance officers verify adherence. Complex trades require all these perspectives; no single person possesses all necessary expertise.

Agentic systems face the same coordination challenge. A single agent trying to do everything quickly exceeds its competence, permission boundaries, or context limits. Multi-agent architectures mirror professional teams: specialized agents with deep expertise, orchestrators that coordinate them, and protocols that enable collaboration.

\begin{definitionbox}[title={Delegation}]
\keyterm{Delegation} assigns subtasks from one agent (the coordinator) to another (the specialist). Unlike escalation (agent to human), delegation is agent to agent. The coordinator defines \textit{what} needs to be done; the specialist determines \textit{how}.

Delegation enables parallelization (multiple specialists work simultaneously), specialization (each agent is optimized for its domain), and security isolation (each agent has only the permissions it needs).
\end{definitionbox}

% ----------------------------------------------------------------------------
% Why Multi-Agent?
% ----------------------------------------------------------------------------

\subsection{Why Multi-Agent Architectures?}
\label{sec:agents2-why-multi-agent}

Several factors drive multi-agent designs \parencite{wu2023autogen,guo2024multiagent}.

\textbf{Specialization} allows agents to excel in narrow domains. A securities law agent can be optimized for SEC regulations and equipped with EDGAR tools. A tax agent handles tax implications. Neither needs expertise in the other's domain.

\textbf{Security isolation} enforces least privilege. A research agent can read legal databases but cannot file documents. A filing agent can submit to CM/ECF but cannot access client financial data. If one agent is compromised, damage is contained.

\textbf{Parallel execution} lets independent workstreams proceed simultaneously. A document review agent analyzes contracts while a research agent investigates legal issues. Neither waits for the other.

\textbf{Vendor diversity} enables best-of-breed selection. A specialized legal model handles research; a general model handles drafting; a fast model handles classification.

\textbf{Scale management} addresses context window limits. Rather than cramming everything into one context, you decompose the task across agents, each with focused context.

The tradeoffs are coordination overhead (communication costs), debugging complexity (failures span agents), and increased attack surface.

% ----------------------------------------------------------------------------
% Agent-to-Agent Protocol (A2A)
% ----------------------------------------------------------------------------

\subsection{Agent-to-Agent Protocol (A2A)}
\label{sec:agents2-a2a}

The Agent-to-Agent Protocol (A2A) standardizes collaboration, complementing MCP \parencite{google-a2a,anthropic-mcp}. If MCP is how agents access resources, A2A is how agents delegate work.

A2A uses familiar professional concepts:
\begin{itemize}[nosep]
    \item \textbf{Agent Cards:} Capability statements (like a résumé) listing expertise, inputs, and outputs.
    \item \textbf{Tasks:} Units of delegated work (like engagement letters) specifying scope, constraints, and deadlines.
    \item \textbf{Artifacts:} Deliverables returned upon completion (memos, reports, data).
    \item \textbf{Channels:} Communication streams for status updates and clarification during execution.
\end{itemize}

\begin{keybox}[title={A2A Task Delegation}]
The task lifecycle mirrors professional delegation:
\begin{enumerate}
    \item \textbf{Discovery:} Finding the right specialist via Agent Card (like finding co-counsel).
    \item \textbf{Delegation:} Creating a Task with goals and constraints (like an engagement letter).
    \item \textbf{Execution:} The specialist works independently, requesting clarification if needed.
    \item \textbf{Delivery:} The specialist returns Artifacts (draft memos).
    \item \textbf{Completion:} The coordinator reviews and approves the work.
\end{enumerate}
\end{keybox}

% ----------------------------------------------------------------------------
% Multi-Agent Patterns
% ----------------------------------------------------------------------------

\subsection{Multi-Agent Patterns}
\label{sec:agents2-orchestration}

Three patterns organize collaboration \parencite{wang2024tdag}.

\textbf{Sequential Delegation:} Specialists work in series. The Coordinator delegates to a Research Agent; output flows to an Analysis Agent, then to a Drafting Agent. This is simple but slow.

\textbf{Parallel Delegation:} Specialists work simultaneously. Securities, Tax, and Employment Agents analyze an acquisition concurrently. The Coordinator integrates findings. This is faster but requires task independence.

\textbf{Hierarchical Delegation:} Specialists delegate to sub-specialists. A Lead Due Diligence Agent delegates to Document Review and Legal Research agents. This handles complexity but introduces overhead.

\input{figures/fig-orchestration-patterns}

Production systems combine MCP and A2A. MCP handles agent-to-tool communication (database access). A2A handles agent-to-agent coordination (task delegation).

Consider M\&A due diligence. The Orchestrator delegates via A2A to specialists. The Document Processing Agent uses MCP to access the data room. The Financial Analysis Agent uses MCP to query financial databases. Each returns Artifacts via A2A, which the Orchestrator synthesizes.

% ----------------------------------------------------------------------------
% Multi-Agent Workflows
% ----------------------------------------------------------------------------

\subsection{Multi-Agent Workflow Examples}
\label{sec:agents2-workflows}

\paragraph{Legal: Regulatory Assessment}
A fintech company asks about regulatory approvals for a new product. The Orchestrator decomposes the request:
\begin{itemize}[nosep]
    \item \textbf{Securities Agent:} Analyzes SEC guidance via MCP; identifies potential registration requirements.
    \item \textbf{Banking Agent:} Checks OCC/FDIC rules via MCP; identifies money transmitter license needs.
    \item \textbf{Consumer Agent:} Reviews CFPB rules; flags disclosure requirements.
    \item \textbf{AML Agent:} Analyzes Bank Secrecy Act obligations; determines KYC needs.
\end{itemize}
The Orchestrator synthesizes these into a prioritized regulatory roadmap.

\paragraph{Finance: Block Trade Execution}
A portfolio manager requests a \$50M block trade. The Orchestrator decomposes the execution:
\begin{itemize}[nosep]
    \item \textbf{Market Agent:} Analyzes liquidity via MCP; recommends VWAP execution over two days.
    \item \textbf{Compliance Agent:} Verifies limits via MCP; notes 13F reporting requirement.
    \item \textbf{Risk Agent:} Assesses portfolio impact via MCP; confirms risk remains within policy.
    \item \textbf{Execution Agent:} Places orders via MCP order management system.
\end{itemize}
The Orchestrator monitors progress and reports completion.

% ----------------------------------------------------------------------------
% Multi-Agent Risks
% ----------------------------------------------------------------------------

\subsection{Multi-Agent Risks}
\label{sec:agents2-coordination-failures}

Multi-agent systems introduce specific failure modes.

\textbf{Coordination Failures:}
\begin{itemize}[nosep]
    \item \textbf{Deadlock:} Agents wait for each other cyclically. Prevention requires timeouts and dependency checks.
    \item \textbf{Divergence:} Specialists reach incompatible conclusions. The orchestrator must reconcile or escalate.
    \item \textbf{Cascading Errors:} Incorrect output propagates. Prevention requires input validation at each handoff.
\end{itemize}

\textbf{Security Risks} \parencite{openid-ai-identity-2024}:
\begin{itemize}[nosep]
    \item \textbf{Identity:} Agents must have verifiable, cryptographic identities to prevent impersonation.
    \item \textbf{Authorization:} Access policies must restrict which agents can delegate to whom.
    \item \textbf{Information Barriers:} Ethical walls must enforce conflict rules across agent boundaries.
    \item \textbf{Auditability:} You must log every delegation (who, what, when) for compliance.
\end{itemize}

% ----------------------------------------------------------------------------
% Protocol Selection
% ----------------------------------------------------------------------------

\subsection{Protocol Selection Guidance}
\label{sec:agents2-protocol-selection}

\begin{table}[htbp]
\centering
\caption{Protocol selection cues}
\label{tab:agents2-protocol-selection}
\small
\begin{tabular}{
  >{\raggedright\arraybackslash}p{0.28\textwidth}
  >{\raggedright\arraybackslash}p{0.12\textwidth}
  >{\raggedright\arraybackslash}p{0.16\textwidth}
  >{\raggedright\arraybackslash}p{0.30\textwidth}
}
\toprule
\textbf{Signal} & \textbf{Protocol} & \textbf{Latency} & \textbf{Examples} \\
\midrule
Immediate, well-defined operation & MCP & ms--seconds & Query database; retrieve document; run calculation \\
\midrule
Delegated work requiring judgment & A2A & minutes--hours & Assign research; request analysis; coordinate specialists \\
\midrule
End-to-end workflow with both & MCP + A2A & blended & Due diligence; portfolio rebalancing; regulatory assessment \\
\bottomrule
\end{tabular}
\end{table}

Use MCP for tools. Use A2A for agents. Use both for complex workflows. As of late 2025, MCP is production-ready \parencite{mcp-spec}. A2A is maturing but cross-vendor reliability varies \parencite{a2a-spec}. Design fallbacks to human coordination where necessary.

In practice, the boundary is this: use MCP when you need a well-defined, auditable operation (``fetch this filing,'' ``calculate this metric''). Use A2A when you need a specialist to run a longer sub-process (``research and synthesize,'' ``draft and revise,'' ``coordinate across constraints'') and you want structured status updates and artifacts.

% ----------------------------------------------------------------------------
% Connection to Other Questions
% ----------------------------------------------------------------------------

\subsection{From Delegation to Governance}
\label{sec:agents2-delegation-governance}

Delegation distributes work, creating governance challenges. Accountability becomes complex: does responsibility lie with the coordinator, the specialist, or the approving human? Information barriers must apply to agents just as they do to humans. Audit trails must span the entire delegation tree.

\Cref{sec:agents2-governance} previews these requirements. Chapter~8 (Agents Part III: Governing Agents) develops them in detail, translating multi-agent delegation into concrete controls: delegation policy, identity and authorization, logging and retention, and organizational accountability.
