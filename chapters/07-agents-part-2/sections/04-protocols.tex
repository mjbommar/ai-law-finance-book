% ============================================================================
% 04-protocols.tex
% Protocols for Safe Interoperation
% Part of: Chapter 07 - Agents Part II: How to Build an Agent
% ============================================================================

\section{Protocols for Safe Interoperation}
\label{sec:agents2-protocols}

Agents do not operate in isolation. They connect to tools, data sources, and other agents. These connections require standardized protocols---shared conventions for communication that ensure different systems can work together safely and reliably.

Think of protocols like the Bluebook for legal citations or GAAP for financial reporting---standardized formats that enable different professionals and systems to understand each other's work. This section examines the two dominant protocols: the Model Context Protocol (MCP) for connecting agents to tools, and the Agent-to-Agent Protocol (A2A) for enabling agents to collaborate with each other.

% ============================================================================
% PROTOCOL LANDSCAPE
% ============================================================================

\subsection{Protocol Landscape}
\label{sec:agents2-proto-landscape}

The agent protocol landscape has consolidated around two complementary standards. MCP handles agent-to-tool communication---the standardized way an agent interacts with databases and systems. A2A handles agent-to-agent collaboration---the standardized way agents delegate work to specialists.

MCP emerged in November 2024 and achieved rapid adoption; by November 2025, over 7,260 MCP servers had been catalogued. A2A launched in April 2025 with fifty-plus enterprise partners and was contributed to the Linux Foundation in June 2025. These protocols complement rather than compete: MCP connects agents to tools; A2A connects agents to each other.

\paragraph{The Integration Problem} Without standardized protocols, ten agents and ten tools would require one hundred unique integrations. Protocols solve this M$\times$N problem: build once, integrate everywhere.

% ============================================================================
% MODEL CONTEXT PROTOCOL (MCP)
% ============================================================================

\subsection{Model Context Protocol (MCP)}
\label{sec:agents2-mcp}

MCP standardizes how agents access external tools and data sources. Before standardization, every research database had different commands and output formats---Westlaw worked one way, Lexis another, Bloomberg a third. MCP creates a common interface: learn the protocol once, access any compatible tool.

\subsubsection{How MCP Works}
\label{sec:agents2-mcp-arch}

The architecture has three roles. The \textit{MCP Host} manages the agent and controls which tools it can access---like the firm's IT system determining database subscriptions. The \textit{MCP Client} is the agent-side component that discovers and uses tools. The \textit{MCP Server} is a tool exposing capabilities through a standardized interface---Westlaw, Bloomberg, or iManage. The \textit{Server Manifest} describes what the tool can do, like a vendor's service catalog.

\begin{figure}[htbp]
\centering
\input{figures/mcp-architecture.tex}
\caption{MCP architecture: the host manages the agent, the agent discovers tools, and tools expose capabilities through standardized interfaces.}
\label{fig:agents2-mcp-architecture}
\end{figure}

Communication follows a simple pattern: server publishes manifest declaring capabilities; client connects through host; client sends structured requests; server returns structured results. The key innovation is that one agent can use \textit{any} MCP-compatible tool without custom integration code.

\subsubsection{MCP Capabilities}
\label{sec:agents2-mcp-capabilities}

MCP servers expose three capability types: \textit{Resources} provide read-only data access (case law, market prices, documents). \textit{Tools} are executable functions that change state (file a document, execute a trade, send a message). \textit{Prompts} are reusable templates for common tasks (contract review checklists, KYC verification workflows).

\begin{keybox}[title={MCP Core Concept}]
\textbf{MCP eliminates the M$\times$N integration problem.}

Without MCP: 10 agents $\times$ 10 tools = 100 custom integrations.

With MCP: 10 agents + 10 tools = 20 implementations (each learns the protocol once).

\textbf{Legal:} One agent queries Westlaw, Lexis, and Bloomberg Law through the same protocol.

\textbf{Financial:} One agent accesses Bloomberg, Reuters, and FactSet through the same protocol.
\end{keybox}

\subsubsection{MCP in Legal and Financial AI}
\label{sec:agents2-mcp-legal}

For legal AI, MCP connects agents to legal research databases, document management systems (iManage, NetDocuments), case management platforms, e-filing APIs, and citation formatters---supporting attorneys, paralegals, and staff across Big Law, boutique firms, and in-house departments.

For financial AI, MCP connects agents to market data feeds (Bloomberg, Reuters), portfolio management systems, compliance databases (KYC/AML, sanctions screening), risk engines (VaR, stress testing), and trade execution platforms---supporting analysts, portfolio managers, traders, and compliance officers on both buy side and sell side.

% ============================================================================
% AGENT-TO-AGENT PROTOCOL (A2A)
% ============================================================================

\subsection{Agent-to-Agent Protocol (A2A)}
\label{sec:agents2-a2a}

A2A enables collaboration between agents, complementing MCP's tool integration. If MCP is how you access resources, A2A is how you delegate work to specialists. Think of A2A as the protocol for how a partner assigns work to an associate or coordinates with outside counsel---define \textit{what} needs to be done, let the specialist determine \textit{how}.

\subsubsection{How A2A Works}
\label{sec:agents2-a2a-arch}

A2A uses familiar professional concepts. \textit{Agent Cards} are capability statements---like a specialist's CV listing expertise, input requirements, and output formats. \textit{Tasks} are units of delegated work---like engagement letters specifying scope, constraints, and deadlines. \textit{Artifacts} are work products returned upon completion---draft memos, analysis reports, structured data. \textit{Communication Channels} support asynchronous, long-running work---matching reality where you assign research Monday and receive the memo Friday.

\subsubsection{Task Lifecycle}
\label{sec:agents2-a2a-principles}

Agent collaboration follows five phases mirroring professional delegation:

\begin{keybox}[title={A2A Task Delegation}]
\textbf{1. DISCOVERY:} Find specialist via Agent Card $\rightarrow$ \textit{Like finding co-counsel through a directory}

\textbf{2. DELEGATION:} Create Task with goals, constraints, deadline $\rightarrow$ \textit{Like an engagement letter}

\textbf{3. EXECUTION:} Specialist works independently, may request clarification $\rightarrow$ \textit{Like an associate researching}

\textbf{4. DELIVERY:} Specialist returns Artifacts $\rightarrow$ \textit{Like submitting a draft memo}

\textbf{5. COMPLETION:} Coordinator reviews, approves, or requests revision $\rightarrow$ \textit{Like partner review}

\textbf{Key insight:} A2A enables delegation without micromanagement---you define WHAT, the specialist decides HOW.
\end{keybox}

The benefit is decoupled execution: multiple specialists work in parallel, long-running analyses proceed asynchronously, and agents from different vendors collaborate through the same protocol.

\subsubsection{A2A in Legal and Financial AI}
\label{sec:agents2-a2a-legal}

A2A enables multi-agent workflows mirroring professional collaboration. In legal practice, a coordinating agent receiving ``Assess regulatory compliance risks for proposed fintech product'' delegates to specialists: a Securities Law Agent, Banking Law Agent, Consumer Protection Agent, and AML Agent. Each works independently using MCP for research databases, returning structured memos via A2A for synthesis into a comprehensive assessment. The pattern applies whether coordinating associates within Big Law, outside counsel for in-house departments, or specialists at boutique firms.

In financial practice, a trading orchestrator receiving ``Execute large block trade minimizing market impact'' delegates to specialists: a Market Agent assesses liquidity via MCP connections to market data; a Compliance Agent validates against position limits; a Risk Agent calculates exposure metrics; an Execution Agent implements the strategy. Each specialist uses MCP for tool access while A2A coordinates the workflow---matching how buy-side portfolio managers coordinate with traders, risk managers, and compliance officers, or how sell-side deal teams coordinate across functions.

% ============================================================================
% DUAL PROTOCOL ARCHITECTURE
% ============================================================================

\subsection{Dual Protocol Strategy}
\label{sec:agents2-dual-protocol}

Production systems typically require both protocols working in concert. Consider M\&A due diligence: the orchestrator delegates via A2A to specialists---Document Processing, Financial Analysis, Legal Risk. Each specialist uses MCP internally: the Document Agent accesses the virtual data room and document management systems; the Financial Agent queries financial databases and modeling tools; the Legal Agent searches legal research platforms and court records. Specialists return Artifacts via A2A (organized indices, risk assessments, legal memoranda) which the orchestrator synthesizes into a comprehensive report.

Throughout, MCP handles agent-to-tool communication (database queries, document retrieval) while A2A handles agent-to-agent coordination (task delegation, artifact delivery). Neither protocol alone suffices---MCP provides the tool integration layer, A2A provides the coordination layer.

% ============================================================================
% PROTOCOL SECURITY
% ============================================================================

\subsection{Protocol Security}
\label{sec:agents2-proto-security}

Protocol security parallels building security: access controls (who can enter), audit trails (who came and went), and segregation (keeping functions separate).

\subsubsection{MCP Security}
\label{sec:agents2-mcp-security}

MCP security controls which agents access which tools and ensures proper logging.

\begin{definitionbox}[title={MCP Security Controls}]
\textbf{Authentication \& Authorization:} Verify agent identity and permissions before tool access

\textbf{Approved Tool Lists:} Limit which MCP servers agents can discover (like firewall policies)

\textbf{Least Privilege:} Grant minimum access required for agent's function

\textbf{Human Oversight:} Require approval for sensitive operations (court filings, trade execution)

\textbf{Audit Logging:} Record all interactions for compliance review

\textbf{Threat Model:}
\begin{itemize}[nosep]
\item \textit{Deceptive tools:} Misleading manifests $\rightarrow$ approved registries, manifest verification
\item \textit{Excessive permissions:} Unauthorized access $\rightarrow$ least privilege, anomaly detection
\end{itemize}
\end{definitionbox}

\subsubsection{A2A Security}
\label{sec:agents2-a2a-security}

A2A security verifies agent identities, controls delegation permissions, and audits collaboration flows.

\begin{keybox}[title={A2A Security Controls}]
\textbf{Cryptographic Signatures:} Verify agent identities (like digitally signed engagement letters)

\textbf{Enterprise Authentication:} Map agents to service accounts with defined roles

\textbf{Audit Logging:} Record all delegations and artifact deliveries

\textbf{Rate Limiting:} Prevent runaway interactions

\textbf{Information Barriers:}
\begin{itemize}[nosep]
\item \textit{Legal:} Conflicts screening prevents cross-matter delegation
\item \textit{Financial:} Chinese walls prevent public/private-side coordination
\end{itemize}
\end{keybox}

% ============================================================================
% PROTOCOL SELECTION GUIDANCE
% ============================================================================

\subsection{Protocol Selection Guidance}
\label{sec:agents2-proto-selection}

Protocol selection follows straightforward principles:

\textbf{Use MCP} when connecting to tools, databases, or APIs. The interaction is synchronous request-response: query legal research, retrieve market data, access documents, execute calculations.

\textbf{Use A2A} when delegating to another agent. The interaction is asynchronous and requires independent judgment: assign research to a specialist, coordinate with outside counsel, request analysis from domain experts.

\textbf{Use both} in production systems. An agent drafting a contract uses MCP to access templates, case law, and client data. An agent coordinating due diligence uses A2A to delegate to financial, legal, and compliance specialists---each of which internally uses MCP for tool access.

The decision signal is clear: if you need immediate results from a defined operation, use MCP. If the work requires independent judgment and takes minutes to hours, use A2A. Most complex legal and financial workflows require both---exactly like human professionals who use databases (MCP-like) while coordinating with colleagues (A2A-like).

