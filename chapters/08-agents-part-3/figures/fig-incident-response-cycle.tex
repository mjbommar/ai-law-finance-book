% Incident Response Cycle - Vertical Flow with Full Descriptions

\begin{figure}[htbp]
\centering
\begin{tikzpicture}[
    stage box/.style={
        draw=slate-700,
        line width=1pt,
        fill=white,
        rounded corners=3pt,
        minimum width=13.5cm,
        minimum height=1.35cm,
        inner sep=8pt
    },
    stage num/.style={
        circle,
        draw=slate-700,
        line width=1.5pt,
        fill=amber-600,
        text=white,
        font=\small\bfseries,
        minimum size=0.7cm,
        inner sep=0pt
    },
    stage title/.style={
        font=\small\bfseries\sffamily,
        text=slate-700,
        anchor=west,
        text width=1.8cm
    },
    stage desc/.style={
        font=\scriptsize,
        text=gray-700,
        text width=9.5cm,
        align=left
    },
    arrow/.style={->, thick, slate-700, >=stealth}
]

% Vertical spacing
\def\vstep{1.7cm}

% Stage 1 - Detect
\node[stage box] (s1) at (0, 0) {};
\node[stage num] at ([xshift=0.55cm]s1.west) {1};
\node[stage title] at ([xshift=1.1cm]s1.west) {Detect};
\node[stage desc, anchor=west] at ([xshift=3.0cm]s1.west) {Monitoring alerts, user complaints, audit findings, or external reports identify a potential issue.};

% Stage 2 - Triage
\node[stage box] (s2) at (0, -\vstep) {};
\node[stage num] at ([xshift=0.55cm]s2.west) {2};
\node[stage title] at ([xshift=1.1cm]s2.west) {Triage};
\node[stage desc, anchor=west] at ([xshift=3.0cm]s2.west) {Assess severity. Fairness violation $\rightarrow$ immediate escalation and halt. Accuracy degradation $\rightarrow$ investigate. Isolated error $\rightarrow$ document. Security breach $\rightarrow$ activate response team.};

% Stage 3 - Contain
\node[stage box] (s3) at (0, -2*\vstep) {};
\node[stage num] at ([xshift=0.55cm]s3.west) {3};
\node[stage title] at ([xshift=1.1cm]s3.west) {Contain};
\node[stage desc, anchor=west] at ([xshift=3.0cm]s3.west) {Limit harm. Fairness/safety failures $\rightarrow$ halt immediately. Accuracy degradation $\rightarrow$ revert to prior model. Security breach $\rightarrow$ isolate affected systems.};

% Stage 4 - Investigate
\node[stage box] (s4) at (0, -3*\vstep) {};
\node[stage num] at ([xshift=0.55cm]s4.west) {4};
\node[stage title] at ([xshift=1.1cm]s4.west) {Investigate};
\node[stage desc, anchor=west] at ([xshift=3.0cm]s4.west) {Root cause analysis. Data quality issue? Model drift? Adversarial attack? Process breakdown (human failed to review)?};

% Stage 5 - Remediate
\node[stage box] (s5) at (0, -4*\vstep) {};
\node[stage num] at ([xshift=0.55cm]s5.west) {5};
\node[stage title] at ([xshift=1.1cm]s5.west) {Remediate};
\node[stage desc, anchor=west] at ([xshift=3.0cm]s5.west) {Fix the root cause. Retrain model, update data sources, patch vulnerability, revise process.};

% Stage 6 - Notify
\node[stage box] (s6) at (0, -5*\vstep) {};
\node[stage num] at ([xshift=0.55cm]s6.west) {6};
\node[stage title] at ([xshift=1.1cm]s6.west) {Notify};
\node[stage desc, anchor=west] at ([xshift=3.0cm]s6.west) {Regulatory notification (if required), affected individuals (if harm occurred), internal stakeholders (board, executives).};

% Stage 7 - Post-Incident Review
\node[stage box] (s7) at (0, -6*\vstep) {};
\node[stage num] at ([xshift=0.55cm]s7.west) {7};
\node[stage title] at ([xshift=1.1cm]s7.west) {Review};
\node[stage desc, anchor=west] at ([xshift=3.0cm]s7.west) {Document lessons learned, update risk assessment, revise controls to prevent recurrence.};

% Arrows between stages
\draw[arrow] (s1.south) -- (s2.north);
\draw[arrow] (s2.south) -- (s3.north);
\draw[arrow] (s3.south) -- (s4.north);
\draw[arrow] (s4.south) -- (s5.north);
\draw[arrow] (s5.south) -- (s6.north);
\draw[arrow] (s6.south) -- (s7.north);

% Feedback loop arrow from Review back to Detect
\draw[arrow, rounded corners=8pt, dashed]
    ([xshift=0.3cm]s7.east) -- ([xshift=1.0cm]s7.east) -- ([xshift=1.0cm]s1.east) -- ([xshift=0.3cm]s1.east);
\node[font=\tiny\sffamily, text=slate-700, rotate=90, anchor=south] at ([xshift=1.55cm, yshift=-5.1cm]s1.east) {Continuous Improvement};

\end{tikzpicture}
\caption{The seven-stage incident response cycle for AI system failures. The dashed feedback loop emphasizes that post-incident review improves detection capabilities, creating continuous improvement in governance controls.}
\label{fig:agents3-incident-response-cycle}
\end{figure}
